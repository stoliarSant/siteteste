var server,http=require("http"),config=require("./config"),fileHandler=require("./filehandler"),parse=require("url").parse,types=config.types,rootFolder=config.rootFolder,defaultIndex=config.defaultIndex;function onRequest(e,r){var t,n=parse(e.url).pathname;"/"===n&&(n=defaultIndex),e=rootFolder+n,t=n.substr(n.lastIndexOf(".")+1),fileHandler(e,function(e){r.writeHead(200,{"Content-Type":types[t]||"text/plain","Content-Length":e.length}),r.end(e)},function(e){r.writeHead(404),r.end()})}module.exports=server=http.createServer(),server.on("request",onRequest);